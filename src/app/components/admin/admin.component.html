<div class="management-container">
  <div class="management-header">
    <div class="header-content">
      <h1>
        <i class="fas fa-users-cog"></i>
        Quản trị hệ thống
      </h1>
      <p>Quản lý thông tin và phân quyền cho người dùng trong hệ thống</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="goBack()">
        <i class="fas fa-arrow-left"></i>
        Quay lại
      </button>
      <button class="btn btn-outline" (click)="logout()">
        <i class="fas fa-sign-out-alt"></i>
        Đăng xuất
      </button>
    </div>
  </div>

  <div class="management-card">
    <div class="card-header">
      <h2>
        <i class="fas fa-users"></i>
        Quản lý người dùng
      </h2>
      <p>Quản lý thông tin và phân quyền cho người dùng trong hệ thống</p>
    </div>
    
    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Đang tải dữ liệu...</p>
      </div>
    </div>

    <!-- Bảng danh sách user -->
    <div *ngIf="!isLoading" class="table-container">
      <div class="table-wrapper">
        <table class="management-table">
          <thead>
            <tr>
              <th>STT</th>
              <th>Username</th>
              <th>Phone</th>
              <th>Email</th>
              <th>Role</th>
              <th>Status</th>
              <th>Thao tác</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of usersList; let i = index" class="table-row">
              <td>{{ i + 1 }}</td>
              <td>{{ user.username }}</td>
              <td>{{ user.phone }}</td>
              <td>{{ user.email }}</td>
              <td>
                <div class="role-selection">
                  <select 
                    [(ngModel)]="selectedRoles[user.username]" 
                    class="form-select"
                    [disabled]="isLoading">
                    <option value="">Chọn role</option>
                    <option 
                      *ngFor="let role of roleOptions" 
                      [value]="role.code">
                      {{ role.name }}
                    </option>
                  </select>
                  <div *ngIf="selectedRoles[user.username]" class="role-preview">
                    <span class="role-label" [ngClass]="'role-' + selectedRoles[user.username].toLowerCase().replace('_', '-')">
                      <i class="fas fa-user-tag"></i>
                      {{ getRoleDisplayName(selectedRoles[user.username]) }}
                    </span>
                  </div>
                </div>
              </td>
              <td>
                <div class="status-selection">
                  <select 
                    [(ngModel)]="selectedStatuses[user.username]" 
                    class="form-select"
                    [disabled]="isLoading">
                    <option 
                      *ngFor="let status of statusOptions" 
                      [value]="status.code">
                      {{ status.name }}
                    </option>
                  </select>
                  <div *ngIf="selectedStatuses[user.username]" class="status-preview">
                    <span class="status-label" [ngClass]="'status-' + selectedStatuses[user.username].toLowerCase()">
                      <i class="fas fa-circle"></i>
                      {{ selectedStatuses[user.username] }}
                    </span>
                  </div>
                </div>
              </td>
              <td>
                <button 
                  class="btn btn-primary btn-sm" 
                  (click)="updateUser(user)"
                  [disabled]="isLoading">
                  <i class="fas fa-save"></i>
                  Cập nhật
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Thông báo khi không có dữ liệu -->
      <div *ngIf="usersList.length === 0" class="no-data-container">
        <div class="no-data-content">
          <i class="fas fa-inbox"></i>
          <h3>Không có dữ liệu người dùng</h3>
          <p>Chưa có người dùng nào trong hệ thống</p>
        </div>
      </div>
    </div>
  </div>
</div>
